{% extends "base.html" %}

{% block content %}
<div class="row mb-5 animate-fade">
    <div class="col-12 text-center text-lg-start d-lg-flex justify-content-between align-items-end">
        <div>
            <span class="badge bg-primary-subtle text-primary mb-2 px-3 py-2 rounded-pill fw-bold">Active Session</span>
            <h1 class="display-5 mb-0">{{ greeting }}, <span class="text-primary">{{ user_name }}</span>!</h1>
            <p class="text-muted lead">Your secure platforms are encrypted and under visual protection.</p>
        </div>
        <div class="mt-4 mt-lg-0">
            <a href="{{ url_for('add_platform') }}" class="btn btn-primary d-inline-flex align-items-center">
                <i class="bi bi-plus-lg me-2"></i> Add New Platform
            </a>
        </div>
    </div>
</div>

<div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 animate-fade" style="animation-delay: 0.1s;">
    {% for platform in platforms %}
    <div class="col">
        <div class="card h-100 overflow-hidden">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-start mb-4">
                    <div class="bg-primary-subtle rounded-3 p-3">
                        <i class="bi bi-shield-check text-primary fs-3"></i>
                    </div>
                    {% if platform.is_locked() %}
                    <span class="badge bg-danger rounded-pill px-3 py-2">Locked</span>
                    {% else %}
                    <span class="badge bg-success-subtle text-success rounded-pill px-3 py-2">Verified Secure</span>
                    {% endif %}
                </div>

                <h3 class="h4 mb-2">{{ platform.platform }}</h3>
                <p class="text-muted small mb-0">
                    <i class="bi bi-tag-fill me-1"></i> Category: {{ platform.category|capitalize }}
                </p>

                {% if platform.is_locked() %}
                <div class="mt-3 p-2 bg-danger-subtle text-danger rounded-3 small">
                    <i class="bi bi-clock-history me-1"></i> Locked until {{ platform.lock_until.strftime('%H:%M %p') }}
                </div>
                {% endif %}
            </div>

            <div class="card-footer bg-light border-0 p-4 pt-0">
                <div class="d-grid gap-2">
                    <a href="{{ url_for('verify', platform_id=platform.id) }}"
                        class="btn btn-primary {% if platform.is_locked() %}disabled{% endif %}">
                        <i class="bi bi-unlock me-2"></i> Reveal Password
                    </a>
                    <a href="{{ url_for('change_image', platform_id=platform.id) }}" class="btn btn-outline-secondary">
                        <i class="bi bi-gear-wide-connected me-2"></i> Security Settings
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% else %}
    <div class="col-12 py-5 text-center">
        <div class="bg-white p-5 rounded-5 border shadow-sm d-inline-block glass-card">
            <i class="bi bi-safe2 display-1 text-primary-subtle"></i>
            <h2 class="mt-4">Your Vault is Empty</h2>
            <p class="text-muted">Start by adding your first platform and a secret image.</p>
            <a href="{{ url_for('add_platform') }}" class="btn btn-primary mt-3 px-5">Get Started</a>
        </div>
    </div>
    {% endfor %}
</div>
{% endblock %}